<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVE Analytics Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <style>
        .metric-card {
            border-left: 4px solid;
            transition: transform 0.2s;
        }
        .metric-card:hover {
            transform: translateY(-2px);
        }
        .critical-border { border-left-color: #dc3545; }
        .high-border { border-left-color: #fd7e14; }
        .medium-border { border-left-color: #ffc107; }
        .low-border { border-left-color: #28a745; }
        .info-border { border-left-color: #17a2b8; }
        .chart-container {
            position: relative;
            height: 400px;
            margin-bottom: 2rem;
        }
        .small-chart {
            height: 250px;
        }
        .progress-ring {
            width: 120px;
            height: 120px;
        }
        .kpi-number {
            font-size: 2.5rem;
            font-weight: bold;
        }
        .kpi-label {
            font-size: 0.9rem;
            color: #6c757d;
        }
        .status-badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
        }
    </style>
</head>
<body class="bg-light">
    <div class="container-fluid py-4">
        <div class="row mb-4">
            <div class="col">
                <h2 class="mb-0">CVE Analytics Dashboard</h2>
                <p class="text-muted">Security vulnerability management overview</p>
            </div>
            <div class="col-auto">
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#detailedModal">
                    View Detailed Analytics
                </button>
            </div>
        </div>

        <!-- Key Metrics Row -->
        <div class="row mb-4">
            <div class="col-md-2">
                <div class="card metric-card critical-border h-100">
                    <div class="card-body text-center">
                        <div class="kpi-number text-danger">847</div>
                        <div class="kpi-label">CRITICAL</div>
                        <small class="text-muted">Immediate Action Required</small>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="card metric-card high-border h-100">
                    <div class="card-body text-center">
                        <div class="kpi-number text-warning">672</div>
                        <div class="kpi-label">HIGH</div>
                        <small class="text-muted">Priority Remediation</small>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="card metric-card medium-border h-100">
                    <div class="card-body text-center">
                        <div class="kpi-number" style="color: #ffc107;">456</div>
                        <div class="kpi-label">MEDIUM</div>
                        <small class="text-muted">Scheduled Fix</small>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="card metric-card low-border h-100">
                    <div class="card-body text-center">
                        <div class="kpi-number text-success">36</div>
                        <div class="kpi-label">LOW</div>
                        <small class="text-muted">Monitor</small>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="card metric-card info-border h-100">
                    <div class="card-body text-center">
                        <div class="kpi-number text-info">2293</div>
                        <div class="kpi-label">UNANALYZED</div>
                        <small class="text-danger">Needs Review</small>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="card metric-card h-100" style="border-left-color: #6f42c1;">
                    <div class="card-body text-center">
                        <div class="kpi-number" style="color: #6f42c1;">473</div>
                        <div class="kpi-label">TICKETS</div>
                        <small class="text-muted">Active Remediation</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts Row -->
        <div class="row mb-4">
            <div class="col-lg-8">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">CVE Priority Distribution & Trends</h5>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="priorityTrendChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="card h-100">
                    <div class="card-header">
                        <h5 class="mb-0">Analysis Progress</h5>
                    </div>
                    <div class="card-body d-flex align-items-center justify-content-center">
                        <div class="text-center">
                            <canvas id="analysisProgressChart" width="200" height="200"></canvas>
                            <div class="mt-3">
                                <div class="row text-center">
                                    <div class="col-6">
                                        <div class="text-success fw-bold">11</div>
                                        <small class="text-muted">Analyzed</small>
                                    </div>
                                    <div class="col-6">
                                        <div class="text-danger fw-bold">2293</div>
                                        <small class="text-muted">Pending</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Status Overview Row -->
        <div class="row mb-4">
            <div class="col-lg-6">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Remediation Status</h5>
                    </div>
                    <div class="card-body">
                        <div class="chart-container small-chart">
                            <canvas id="statusChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Recent Activity</h5>
                    </div>
                    <div class="card-body">
                        <div class="chart-container small-chart">
                            <canvas id="activityChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Modal -->
    <div class="modal fade" id="detailedModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Detailed CVE Analytics</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row mb-4">
                        <div class="col-md-4">
                            <div class="card bg-light">
                                <div class="card-body">
                                    <h6 class="card-title">Risk Metrics</h6>
                                    <div class="mb-2">
                                        <span class="badge bg-danger me-2">Critical Risk Score: 8.7/10</span>
                                    </div>
                                    <div class="mb-2">
                                        <span class="badge bg-warning">Avg. Days to Fix: 14.2</span>
                                    </div>
                                    <div class="mb-2">
                                        <span class="badge bg-info">Coverage: 47.3%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card bg-light">
                                <div class="card-body">
                                    <h6 class="card-title">Team Performance</h6>
                                    <div class="mb-2">
                                        <small class="text-muted">Analysis Capacity</small>
                                        <div class="progress">
                                            <div class="progress-bar bg-danger" style="width: 15%"></div>
                                        </div>
                                        <small>Overloaded (15% capacity)</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card bg-light">
                                <div class="card-body">
                                    <h6 class="card-title">Compliance</h6>
                                    <div class="mb-2">
                                        <span class="badge bg-success">Fixed: 234</span>
                                    </div>
                                    <div class="mb-2">
                                        <span class="badge bg-secondary">Verified: 189</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-8">
                            <h6>CVE Severity Heat Map by Time</h6>
                            <canvas id="heatmapChart" style="height: 300px;"></canvas>
                        </div>
                        <div class="col-lg-4">
                            <h6>Top Affected Components</h6>
                            <canvas id="componentsChart" style="height: 300px;"></canvas>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-primary">Export Report</button>
                    <button type="button" class="btn btn-outline-secondary">Schedule Report</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Priority Trend Chart
        const priorityCtx = document.getElementById('priorityTrendChart').getContext('2d');
        new Chart(priorityCtx, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep'],
                datasets: [
                    {
                        label: 'Critical',
                        data: [750, 820, 780, 890, 847, 832, 845, 867, 847],
                        borderColor: '#dc3545',
                        backgroundColor: 'rgba(220, 53, 69, 0.1)',
                        tension: 0.3
                    },
                    {
                        label: 'High',
                        data: [520, 580, 610, 645, 672, 658, 670, 685, 672],
                        borderColor: '#fd7e14',
                        backgroundColor: 'rgba(253, 126, 20, 0.1)',
                        tension: 0.3
                    },
                    {
                        label: 'Medium',
                        data: [320, 380, 420, 445, 456, 448, 451, 459, 456],
                        borderColor: '#ffc107',
                        backgroundColor: 'rgba(255, 193, 7, 0.1)',
                        tension: 0.3
                    },
                    {
                        label: 'Low',
                        data: [25, 28, 32, 35, 36, 34, 35, 37, 36],
                        borderColor: '#28a745',
                        backgroundColor: 'rgba(40, 167, 69, 0.1)',
                        tension: 0.3
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        // Analysis Progress Doughnut Chart
        const progressCtx = document.getElementById('analysisProgressChart').getContext('2d');
        new Chart(progressCtx, {
            type: 'doughnut',
            data: {
                labels: ['Analyzed', 'Not Analyzed'],
                datasets: [{
                    data: [11, 2293],
                    backgroundColor: ['#28a745', '#dc3545'],
                    borderWidth: 0
                }]
            },
            options: {
                responsive: false,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                cutout: '70%'
            }
        });

        // Status Chart
        const statusCtx = document.getElementById('statusChart').getContext('2d');
        new Chart(statusCtx, {
            type: 'bar',
            data: {
                labels: ['Accepted', 'Fixed', 'Verified', 'Rejected', 'Not Affected'],
                datasets: [{
                    label: 'Count',
                    data: [0, 3, 0, 3, 4],
                    backgroundColor: [
                        '#17a2b8',
                        '#28a745',
                        '#6f42c1',
                        '#dc3545',
                        '#6c757d'
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });

        // Activity Chart (Sample data)
        const activityCtx = document.getElementById('activityChart').getContext('2d');
        new Chart(activityCtx, {
            type: 'line',
            data: {
                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                datasets: [{
                    label: 'New CVEs',
                    data: [45, 67, 23, 89],
                    borderColor: '#dc3545',
                    tension: 0.3
                }, {
                    label: 'Resolved',
                    data: [12, 18, 8, 24],
                    borderColor: '#28a745',
                    tension: 0.3
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });
    </script>
</body>
</html>
